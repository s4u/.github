name: 'Setup'
description: 'Common Project properties'

outputs:
  branch:
    description: ''
    value: ${{ steps.setup.outputs.branch }}
  date-ym:
    description: ''
    value: ${{ steps.setup.outputs.date-ym }}
  sonar:
    description: ''
    value: '2de0e32b2b3108965f76a4713ba2028978c233ed'
  maven-matrix:
    description: ''
    value: ${{ steps.setup.outputs.maven-matrix }}
  maven-default:
    description: ''
    value: '3.8.2'

runs:
  using: "composite"
  steps:
    - uses: actions/checkout@v2.3.4
      with:
        persist-credentials: false

    - name: Read preoject environemnts
      shell: bash
      run: |
        if [ -f .github/build.env ]; then
          echo "Use project build.env"
          cat .github/build.env >> $GITHUB_ENV;
        fi

    - name: Set outputs
      shell: bash
      id: setup
      run: |
        echo "::set-output name=branch::${GITHUB_REF#refs/heads/}"
        echo "::set-output name=date-ym::$(date +%y%m)"

        : ${MAVEN_MATRIX:=[\"3.8.2\"]}
        echo "::set-output name=maven-matrix::${MAVEN_MATRIX}"
